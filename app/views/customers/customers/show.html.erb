<div class="container px-5 px-sm-0">
  <div class="row">
    <div class="col-lg-10 mx-auto">
      <%= flash[:notice] %>
      <%= flash[:alert] %>
      <div class="card shadow-lg px-3 py-3">
        <div class="card-body">
          <div class="row align-items-center">
            <div class="col-12 col-sm-2">
              <%= image_tag @customer.get_profile_image(120, 120) %>
            </div>
            <div class="col-12 col-sm-6 col-md-8">
              <h3 class="mb-4 customer-name"><%= @customer.name %></h3>
              <div class="travel-info">
                <div class="travel-info__item travel-info__item--followers">
                  <p class="travel-info__value">
                    <%= link_to customer_followers_path(@customer) do %>
                      <%= @customer.followers.count %>
                    <% end %>
                  </p>
                  <p class="travel-info__label">フォロワー</p>
                </div>
                <div class="travel-info__item travel-info__item--followings">
                  <p class="travel-info__value">
                    <%= link_to customer_followings_path(@customer) do %>
                      <%= @customer.followings.count %>
                    <% end %>
                  </p>
                  <p class="travel-info__label">フォロー中</p>
                </div>
                <div class="travel-info__item travel-info__item--trips">
                  <p class="travel-info__value"><%= @customer.posts.count %></p>
                  <p class="travel-info__label">旅行</p>
                </div>
                <div class="travel-info__item travel-info__item--total-days">
                  <p class="travel-info__value">
                    <%= (@customer.posts.sum { |post| (post.return_date - post.departure_date).to_i + 1 }).to_s %>
                  </p>
                  <p class="travel-info__label">累計旅行日数</p>
                </div>
              </div>
            </div>
          </div>
          <div class="row mt-4">
            <div class="col-12">
              <% if @customer.name != "guestuser" %>
                <% if @customer.introduction.present? %>
                  <p><%= @customer.introduction %></p>
                <% else %>
                  <p>自己紹介文はありません</p>
                <% end %>
              <% else %>
                <p>ゲストユーザーです。</p>
              <% end %>
            </div>
          </div>
          <div class="row">
            <div class="col-12">
              <% if current_customer == @customer && @customer.name != "guestuser" %>
                <%= link_to edit_customer_path(@customer), class: "btn btn-outline-secondary btn-block" do %>
                  <i class="fas fa-user-cog"></i>
                <% end %>
              <% else %>
                <% if @customer.name != "guestuser" %>
                  <% if current_customer.following?(@customer) %>
                    <%= link_to "フォロー中", customer_relationships_path(@customer.id), class: "btn btn-sm btn-primary", method: :delete %>
                  <% else %>
                    <%= link_to "フォロー", customer_relationships_path(@customer.id), class: "btn btn-sm btn-success", method: :post %>
                  <% end %>
                <% end %>
              <% end %>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-lg-10 mx-auto">
      <%= render 'customers/posts/posts_list', posts: @posts %>
    </div>
  </div>
</div>

<style>

  .travel-info {
    display: flex;
    flex-wrap: wrap;
    justify-content: space-between;
    margin-bottom: 20px;
  }

  .travel-info__item {
    flex: 0 0 25%;
    text-align: center;
  }

  .travel-info__value {
    font-size: 24px;
    font-weight: bold;
    margin-bottom: 5px;
  }

  .travel-info__label {
    font-size: 14px;
    color: #888;
  }

  .travel-info__item--trips {
    border-right: 1px solid #888;
  }

  .travel-info__item--total-days {
    border-left: 1px solid #888;
  }

  .customer-name {
    margin-left: 10px;
  }

</style>

